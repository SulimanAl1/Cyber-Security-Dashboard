<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSecurity Dashboard v2.3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            dark: '#050a14',
                            slate: '#111827',
                            blue: '#00f0ff',
                            red: '#ff2a6d',
                            green: '#05ffa1',
                            yellow: '#ffc800'
                        }
                    },
                    boxShadow: {
                        'glow-blue': '0 0 15px -3px rgba(0, 240, 255, 0.3)',
                        'glow-red': '0 0 15px -3px rgba(255, 42, 109, 0.3)',
                        'glow-green': '0 0 15px -3px rgba(5, 255, 161, 0.3)',
                        'screen': 'inset 0 0 20px rgba(0,0,0,0.5)'
                    }
                }
            }
        }
    </script>
    <style>
        /* Cyber-Security Aesthetic Theme */
        :root {
            --bg-dark: #050a14;
            --text-primary: #f8fafc;
        }
        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(0, 240, 255, 0.1) 0%, transparent 50%),
                linear-gradient(rgba(0, 0, 0, 0.1) 50%, transparent 50%);
            background-size: 100% 100%, 4px 4px;
            min-height: 100vh;
        }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0f1d; }
        ::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #374151; }

        /* Animations & Effects */
        .slide-in { animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .pulse-signal { animation: pulseRed 2s infinite; }
        @keyframes pulseRed {
            0% { box-shadow: 0 0 0 0 rgba(255, 42, 109, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 42, 109, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 42, 109, 0); }
        }

        .cyber-card {
            background: linear-gradient(145deg, #111827, #0d1220);
            border: 1px solid #1f2937;
            box-shadow: inset 0 1px 1px rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }
        .cyber-card:hover {
            border-color: #374151;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
        }
        
        /* Chart Styles */
        .chart-glow { filter: drop-shadow(0 0 8px rgba(0, 240, 255, 0.6)); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- DATA SOURCES ---
        const FEED_SOURCES = [
            { name: 'Cisco Talos Intelligence', url: 'https://blog.talosintelligence.com/rss/' },
            { name: 'Abuse.ch URLhaus', url: 'https://abuse.ch/feed/' },
            { name: 'SANS Internet Storm Center', url: 'https://isc.sans.edu/rssfeed.xml' },
            { name: 'CISA (KEV/Alerts)', url: 'https://www.cisa.gov/uscert/ncas/current-activity.xml' },
            { name: 'EuRepoC (Incidents)', url: 'https://www.enisa.europa.eu/news/@@rss' },
            { name: 'BleepingComputer', url: 'https://www.bleepingcomputer.com/feed/' },
            { name: 'The Hacker News', url: 'https://feeds.feedburner.com/TheHackersNews' },
            { name: 'Krebs on Security', url: 'https://krebsonsecurity.com/feed/' },
            { name: 'Dark Reading', url: 'https://www.darkreading.com/rss.xml' }
        ];

        // --- HISTORICAL DATA (Oct-Nov 2025) ---
        const HISTORICAL_DATA = [
            { id: 2001, date: "2025-11-28", target: "Global Logistics Co.", sector: "Logistics", method: "Ransomware", attacker: "LockBit 4.0", impact: "Shipping manifest system offline worldwide.", cost: "$5.2 Million", remediation: "Isolate Asia-Pacific nodes. Revert to paper manifest.", source: "Intel Report" },
            { id: 2002, date: "2025-11-27", target: "Sony Group Corp.", sector: "Technology", method: "Data Extortion", attacker: "Qilin", impact: "2TB of dev data & employee PII encrypted.", cost: "$15 Million", remediation: "Network segmentation. Forced credential rotation globally.", source: "Archive" },
            { id: 2003, date: "2025-11-26", target: "Nvidia", sector: "Tech/Chip", method: "Espionage", attacker: "Lapsus$ Returns", impact: "Source code for new driver architecture leaked.", cost: "$250M (IP Value)", remediation: "Enhanced endpoint monitoring. Legal takedowns.", source: "Archive" },
            { id: 2004, date: "2025-11-24", target: "DHL Supply Chain", sector: "Logistics", method: "Phishing/BEC", attacker: "TA577", impact: "Shipping redirects affecting 50k parcels.", cost: "$4.2 Million", remediation: "Implement hardware FIDO2 keys for logistics admins.", source: "Archive" },
            { id: 2005, date: "2025-11-21", target: "JP Morgan Chase (Cloud)", sector: "Finance", method: "DDoS", attacker: "Killnet", impact: "Consumer banking app latency (5000ms).", cost: "$1.5M (SLA)", remediation: "Traffic scrubbing via Akamai/Cloudflare.", source: "Archive" },
            { id: 2006, date: "2025-11-18", target: "Canon Inc.", sector: "Manufacturing", method: "Zero-Day Exploit", attacker: "Cl0p", impact: "Exfiltration of blueprints via MOVEit 3.0 flaw.", cost: "$12.5 Million", remediation: "Patch CVE-2025-8821. Isolate file transfer appliances.", source: "Archive" },
            { id: 2007, date: "2025-11-15", target: "National Grid (UK)", sector: "Energy", method: "ICS Probe", attacker: "Sandworm", impact: "Telemetry interruption in 4 substations.", cost: "Operational", remediation: "Air-gap critical ICS segments. Hunt for malware.", source: "Archive" },
            { id: 2008, date: "2025-11-12", target: "Ascension Health", sector: "Healthcare", method: "Ransomware", attacker: "BlackCat", impact: "EHR downtime across 14 states. Patient diversion.", cost: "$45 Million", remediation: "Restore from offline immutable backups. Rebuild AD forest.", source: "Archive" },
            { id: 2009, date: "2025-11-08", target: "OpenAI API", sector: "Technology", method: "DDoS", attacker: "Anonymous Sudan", impact: "API Gateway 502 Errors for 4 hours.", cost: "$800k Credits", remediation: "Scale ingress controllers. Rate limiting adjustment.", source: "Archive" },
            { id: 2010, date: "2025-11-02", target: "BMW Group", sector: "Automotive", method: "Ind. Espionage", attacker: "APT29", impact: "EV Battery research data accessed.", cost: "Strategic Loss", remediation: "Internal network audit. MFA enforcement.", source: "Archive" },
            { id: 2011, date: "2025-10-31", target: "Lockheed Martin", sector: "Defense", method: "Phishing", attacker: "Nobelium", impact: "Unauthorized access to unclassified email server.", cost: "Undisclosed", remediation: "Forensic image of Exchange servers. Reset federated trusts.", source: "Archive" },
            { id: 2012, date: "2025-10-28", target: "Costco Wholesale", sector: "Retail", method: "POS Malware", attacker: "Fin7", impact: "Credit card scraping in 40 west coast locations.", cost: "$8 Million", remediation: "Re-image POS terminals. End-to-end encryption audit.", source: "Archive" },
            { id: 2013, date: "2025-10-25", target: "Toyota Motor Corp.", sector: "Automotive", method: "API Leak", attacker: "Unknown", impact: "T-Connect app data exposed 2M customer locations.", cost: "GDPR Fine (Est.)", remediation: "Implement strict API schema validation. Rotate keys.", source: "Archive" },
            { id: 2014, date: "2025-10-22", target: "Harvard University", sector: "Education", method: "Ransomware", attacker: "Royal", impact: "Research database locked. Admin systems offline.", cost: "$1 Million", remediation: "Refusal to pay. Restore from tape backup.", source: "Archive" },
            { id: 2015, date: "2025-10-18", target: "City of Dallas", sector: "Government", method: "Ransomware", attacker: "Royal", impact: "Municipal courts and police dispatch limited.", cost: "$3 Million", remediation: "Re-image 1,200 workstations. Deploy EDR.", source: "Archive" },
            { id: 2016, date: "2025-10-14", target: "Binance", sector: "Crypto", method: "Bridge Exploit", attacker: "Lazarus Group", impact: "Potential $100M unauthorized withdrawal halted.", cost: "$100M (Frozen)", remediation: "Suspend cross-chain bridge. Smart contract audit.", source: "Archive" },
            { id: 2017, date: "2025-10-10", target: "23andMe", sector: "BioTech", method: "Credential Stuffing", attacker: "GnosticPlayers", impact: "Genomic data scraping of 4M accounts.", cost: "$30M Settlement", remediation: "Force MFA reset for all users. Deprecate legacy API.", source: "Archive" },
            { id: 2018, date: "2025-10-05", target: "Verizon", sector: "Telecom", method: "Insider Threat", attacker: "Employee", impact: "SIM Swapping capability sold on dark web.", cost: "Legal Fees", remediation: "Restrict access to subscriber SIM tools.", source: "Archive" },
            { id: 2019, date: "2025-10-02", target: "Salesforce", sector: "Tech", method: "Misconfiguration", attacker: "N/A", impact: "Internal 'Ghost' permission allowed data view.", cost: "Trust Loss", remediation: "Rollback permission sets. Automated config audit.", source: "Archive" },
            { id: 301, date: "2025-09-28", target: "MGM Resorts", sector: "Hospitality", method: "Social Engineering", attacker: "Scattered Spider", impact: "Slot machines offline, room keys inoperable for 5 days.", cost: "$100 Million", remediation: "Rebuild Identity Management (IdM) stack.", source: "Archive" },
        ];

        // --- UTILITY: Heuristics & Analysis ---
        const analyzeText = (text) => {
            const lower = text.toLowerCase();
            let attacker = "Unknown Group";
            let method = "Cyber Incident";
            let sector = "General";
            let detectedCost = "Undisclosed";
            let remediation = "Conduct root cause analysis. Review vendor bulletins for IOCs.";

            // --- SMART COST DETECTION ---
            const moneyRegex = /\$(\d+(?:\.\d+)?)\s*(million|billion|m|b|k)|(\d+(?:\.\d+)?)\s*(million|billion)\s*dollars/i;
            const moneyMatch = text.match(moneyRegex);
            if (moneyMatch) {
                detectedCost = moneyMatch[0].toUpperCase();
            } else if (lower.includes('ransom paid')) {
                detectedCost = "Ransom Paid (Unknown)";
            } else if (lower.includes('fine')) {
                detectedCost = "Regulatory Fines";
            }

            // --- ATTACKER DETECTION ---
            if (lower.includes('cl0p') || lower.includes('clop')) attacker = "Cl0p";
            else if (lower.includes('lockbit')) attacker = "LockBit";
            else if (lower.includes('blackcat') || lower.includes('alphv')) attacker = "ALPHV/BlackCat";
            else if (lower.includes('scattered spider')) attacker = "Scattered Spider";
            else if (lower.includes('lapsus')) attacker = "Lapsus$";
            else if (lower.includes('qilin')) attacker = "Qilin";
            else if (lower.includes('apt29') || lower.includes('midnight blizzard')) attacker = "Nobelium (APT29)";
            else if (lower.includes('lazarus')) attacker = "Lazarus Group";
            else if (lower.includes('sandworm')) attacker = "Sandworm";
            else if (lower.includes('killnet')) attacker = "Killnet";
            else if (lower.includes('royal')) attacker = "Royal Ransomware";
            else if (lower.includes('anonymous')) attacker = "Anonymous Sudan";
            else if (lower.includes('darkangels')) attacker = "DarkAngels";
            else if (lower.includes('bianlian')) attacker = "BianLian";
            else if (lower.includes('ta577')) attacker = "TA577";
            else if (lower.includes('fin7')) attacker = "Fin7";

            // --- METHOD DETECTION & DYNAMIC REMEDIATION ---
            if (lower.includes('ransomware')) {
                method = "Ransomware";
                remediation = "Isolate infected systems immediately. Do NOT pay ransom. Restore from offline backups and rotate admin credentials.";
            }
            else if (lower.includes('phish') || lower.includes('social engineering')) {
                method = "Phishing";
                remediation = "Reset compromised user passwords. Revoke active sessions. Scan for email forwarding rules and implement FIDO2 MFA.";
            }
            else if (lower.includes('ddos')) {
                method = "DDoS Attack";
                remediation = "Activate upstream DDoS protection. Implement rate limiting on API endpoints and geo-blocking if applicable.";
            }
            else if (lower.includes('vulnerability') || lower.includes('exploit') || lower.includes('zero-day') || lower.includes('cve') || lower.includes('kev')) {
                method = "Vuln Exploitation";
                remediation = "Apply vendor patches immediately. If patches are unavailable, implement WAF rules or network segmentation.";
            }
            else if (lower.includes('leak') || lower.includes('breach') || lower.includes('stolen') || lower.includes('exfiltration')) {
                method = "Data Breach";
                remediation = "Identify scope of data loss. Reset all user passwords. Notify legal team and affected data subjects.";
            }
            else if (lower.includes('malware') || lower.includes('backdoor') || lower.includes('botnet') || lower.includes('trojan')) {
                method = "Malware";
                remediation = "Re-image infected machines. Update EDR signatures. Block command & control (C2) domains at the firewall.";
            }
            else if (lower.includes('insider') || lower.includes('employee')) {
                method = "Insider Threat";
                remediation = "Revoke user access immediately. Preserve logs for legal evidence. Conduct user behavior analytics (UBA) review.";
            }

            // --- SECTOR DETECTION ---
            if (lower.includes('hospital') || lower.includes('health') || lower.includes('patient') || lower.includes('clinic')) sector = "Healthcare";
            else if (lower.includes('bank') || lower.includes('financial') || lower.includes('crypto')) sector = "Finance";
            else if (lower.includes('government') || lower.includes('ministry') || lower.includes('state') || lower.includes('federal')) sector = "Government";
            else if (lower.includes('school') || lower.includes('university') || lower.includes('college')) sector = "Education";
            else if (lower.includes('airline') || lower.includes('airport') || lower.includes('aviation')) sector = "Aviation";
            else if (lower.includes('utility') || lower.includes('energy') || lower.includes('grid') || lower.includes('power')) sector = "Energy";
            else if (lower.includes('tech') || lower.includes('cloud') || lower.includes('cyber') || lower.includes('app')) sector = "Technology";
            else if (lower.includes('retail') || lower.includes('shop') || lower.includes('store')) sector = "Retail";
            else if (lower.includes('hotel') || lower.includes('resort')) sector = "Hospitality";

            return { attacker, method, sector, detectedCost, remediation };
        };

        const generateFallbackLiveEvents = () => {
            const today = new Date().toISOString().split('T')[0];
            return [
                { id: 'simulated-1', date: today, target: "Global FinTech Clearinghouse", sector: "Finance", method: "DDoS", attacker: "Killnet", impact: "Transaction latency spikes detected globally.", cost: "Undisclosed", remediation: "Activate upstream DDoS protection. Implement rate limiting on API endpoints.", source: "Live Monitor (Simulated)" },
                { id: 'simulated-2', date: today, target: "Regional Utility Provider", sector: "Energy", method: "Ransomware", attacker: "LockBit 3.0", impact: "Administrative networks encrypted. Grid ops normal.", cost: "$2M Demand", remediation: "Isolate infected systems immediately. Do NOT pay ransom. Restore from offline backups.", source: "Live Monitor (Simulated)" },
                { id: 'simulated-3', date: today, target: "Cloud Storage Alpha", sector: "Technology", method: "Zero-Day", attacker: "Unknown", impact: "Potential unauth access to S3 buckets.", cost: "Investigation", remediation: "Apply vendor patches immediately. Implement WAF rules.", source: "Live Monitor (Simulated)" }
            ];
        };

        // --- VISUAL COMPONENTS ---
        const TrendChart = ({ data }) => {
            const trend = data.reduce((acc, curr) => {
                if (!curr.date) return acc;
                const dateParts = curr.date.split('-');
                if (dateParts.length < 3) return acc;
                const dateKey = `${dateParts[0]}-${dateParts[1]}`; // YYYY-MM
                acc[dateKey] = (acc[dateKey] || 0) + 1;
                return acc;
            }, {});

            const entries = Object.entries(trend);
            entries.sort((a, b) => a[0].localeCompare(b[0]));
            const points = entries;
            const maxVal = Math.max(...Object.values(trend)) || 1;

            const polylinePoints = points.map((p, i) => {
                const x = (i / (points.length - 1 || 1)) * 300;
                const y = 100 - (p[1] / maxVal) * 80;
                return `${x},${y}`;
            }).join(' ');

            return (
                <div className="w-full h-48 cyber-card rounded-xl p-6 relative overflow-hidden group">
                    <div className="absolute inset-0 bg-cyber-blue/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    <h4 className="text-sm font-bold text-cyber-blue uppercase mb-4 tracking-wider flex items-center gap-2">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/></svg>
                        Incident Velocity (Timeline)
                    </h4>
                    <svg viewBox="0 0 300 100" className="w-full h-full overflow-visible">
                         <defs>
                            <linearGradient id="chartGradient" x1="0" x2="0" y1="0" y2="1">
                                <stop offset="0%" stopColor="#00f0ff" stopOpacity="0.4" />
                                <stop offset="100%" stopColor="#00f0ff" stopOpacity="0" />
                            </linearGradient>
                        </defs>
                        <line x1="0" y1="20" x2="300" y2="20" stroke="#1f2937" strokeWidth="0.5" strokeDasharray="4 4"/>
                        <line x1="0" y1="60" x2="300" y2="60" stroke="#1f2937" strokeWidth="0.5" strokeDasharray="4 4"/>
                        <line x1="0" y1="100" x2="300" y2="100" stroke="#374151" strokeWidth="1"/>
                        {points.length > 1 && (
                            <>
                                <polygon points={`0,100 ${polylinePoints} 300,100`} fill="url(#chartGradient)" />
                                <polyline points={polylinePoints} fill="none" stroke="#00f0ff" strokeWidth="2" className="chart-glow" />
                                {points.map((p, i) => {
                                    const x = (i / (points.length - 1 || 1)) * 300;
                                    const y = 100 - (p[1] / maxVal) * 80;
                                    return (
                                        <circle key={i} cx={x} cy={y} r="3" fill="#050a14" stroke="#00f0ff" strokeWidth="2" className="hover:r-5 transition-all cursor-pointer relative z-10">
                                            <title>{p[0]}: {p[1]} Incidents</title>
                                        </circle>
                                    )
                                })}
                            </>
                        )}
                    </svg>
                </div>
            );
        };

        const TypeDistributionChart = ({ data }) => {
            const counts = data.reduce((acc, curr) => {
                const type = curr.method.split(' ')[0]; // Group loosely
                acc[type] = (acc[type] || 0) + 1;
                return acc;
            }, {});

            const sorted = Object.entries(counts).sort((a,b) => b[1] - a[1]).slice(0, 5); // Top 5
            const maxVal = Math.max(...Object.values(counts)) || 1;

            return (
                <div className="w-full h-48 cyber-card rounded-xl p-6 relative overflow-hidden">
                    <h4 className="text-sm font-bold text-cyber-red uppercase mb-4 tracking-wider flex items-center gap-2">
                        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                        Threat Vector Distribution
                    </h4>
                    <div className="space-y-3">
                        {sorted.map(([type, count]) => {
                            const widthPercent = (count / maxVal) * 100;
                            return (
                                <div key={type} className="group">
                                    <div className="flex justify-between text-[10px] uppercase font-bold text-slate-400 mb-1">
                                        <span>{type}</span>
                                        <span>{count}</span>
                                    </div>
                                    <div className="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                                        <div className="h-full bg-cyber-red shadow-glow-red rounded-full transition-all duration-1000" style={{ width: `${widthPercent}%` }}></div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        const DailyReport = ({ data, date }) => {
            const daysEvents = data.filter(d => d.date === date);
            return (
                <div className="bg-slate-50 text-slate-900 p-10 max-w-4xl mx-auto shadow-2xl slide-in border-t-8 border-cyber-red">
                    <div className="border-b-2 border-slate-300 pb-6 mb-8 flex justify-between items-end">
                        <div>
                            <h1 className="text-4xl font-black uppercase tracking-tighter text-slate-900">Daily Cyber Intelligence Briefing</h1>
                            <p className="text-sm font-bold text-cyber-red mt-2 uppercase tracking-widest">TLP:AMBER // INTERNAL USE ONLY</p>
                        </div>
                        <div className="text-right">
                            <div className="text-2xl font-bold font-mono text-slate-700">{date}</div>
                            <div className="text-xs uppercase text-slate-500 font-mono">ID: {date.replace(/-/g, '')}-CS-BRIEF</div>
                        </div>
                    </div>
                    {daysEvents.length === 0 ? (
                        <div className="text-center py-16 italic text-slate-500 bg-slate-100 rounded-lg border border-dashed border-slate-300">No major incidents recorded for this date.</div>
                    ) : (
                        <div className="space-y-8">
                            {daysEvents.map(evt => (
                                <div key={evt.id} className="border-l-4 border-cyber-blue pl-6 py-2 relative">
                                    <div className="flex justify-between items-start mb-3">
                                        <h3 className="text-xl font-bold text-slate-800">{evt.target} <span className="text-slate-500 text-base font-medium ml-2">({evt.sector})</span></h3>
                                        <span className="bg-slate-900 text-cyber-blue px-3 py-1 text-xs font-bold uppercase tracking-wider rounded-sm">{evt.attacker}</span>
                                    </div>
                                    <div className="grid grid-cols-2 gap-y-2 gap-x-8 text-sm mb-4 text-slate-600">
                                        <div className="flex"><strong className="w-20 text-slate-900">Method:</strong> {evt.method}</div>
                                        <div className="flex justify-end"><strong className="mr-2 text-slate-900">Est. Loss:</strong> <span className="text-red-600 font-mono font-bold">{evt.cost}</span></div>
                                        <div className="col-span-2 mt-2"><strong className="block text-slate-900 mb-1">Impact Assessment:</strong> <span className="leading-relaxed">{evt.impact}</span></div>
                                    </div>
                                    <div className="bg-red-50 border-l-4 border-red-500 p-4 text-sm text-red-900 font-medium rounded-r-md">
                                        <strong className="block uppercase text-xs text-red-600 mb-1">Recommended Action:</strong>
                                        {evt.remediation}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        function App() {
            const [view, setView] = useState('dashboard');
            const [searchTerm, setSearchTerm] = useState("");
            const [selectedEvent, setSelectedEvent] = useState(null);
            
            // PAGINATION STATE
            const [currentPage, setCurrentPage] = useState(1);
            const itemsPerPage = 10;

            const [liveData, setLiveData] = useState([]);
            const [isSyncing, setIsSyncing] = useState(false);
            const [lastUpdated, setLastUpdated] = useState("Never");

            // --- LIVE FETCHING LOGIC ---
            const fetchLiveFeeds = async () => {
                setIsSyncing(true);
                const allItems = [];
                const proxyUrl = "https://corsproxy.io/?";
                
                const fetchPromises = FEED_SOURCES.map(async (source) => {
                    try {
                        const response = await fetch(proxyUrl + encodeURIComponent(source.url));
                        if (!response.ok) return;
                        const text = await response.text();
                        const parser = new DOMParser();
                        const xml = parser.parseFromString(text, "text/xml");
                        const items = xml.querySelectorAll("item");

                        items.forEach((item, index) => {
                            const title = item.querySelector("title")?.textContent || "Unknown Event";
                            const description = item.querySelector("description")?.textContent || "No details available.";
                            const pubDateRaw = item.querySelector("pubDate")?.textContent;
                            const dateObj = pubDateRaw ? new Date(pubDateRaw) : new Date();
                            const dateStr = dateObj.toISOString().split('T')[0];
                            const { attacker, method, sector, detectedCost, remediation } = analyzeText(title + " " + description);

                            allItems.push({
                                id: `live-${source.name}-${index}`,
                                date: dateStr,
                                target: title,
                                sector: sector,
                                method: method,
                                attacker: attacker,
                                impact: description.replace(/<[^>]*>?/gm, '').substring(0, 150) + "...",
                                cost: detectedCost, // Auto-detected
                                remediation: remediation, // Dynamic Remediation
                                source: source.name,
                                link: item.querySelector("link")?.textContent
                            });
                        });
                    } catch (error) { }
                });

                await Promise.all(fetchPromises);
                
                if (allItems.length === 0) {
                    const simulated = generateFallbackLiveEvents();
                    allItems.push(...simulated);
                }

                const combined = [...allItems, ...HISTORICAL_DATA].sort((a, b) => new Date(b.date) - new Date(a.date));
                setLiveData(combined);
                setLastUpdated(new Date().toLocaleTimeString());
                setIsSyncing(false);
            };

            useEffect(() => {
                fetchLiveFeeds();
            }, []);

            // Pagination Reset
            useEffect(() => {
                setCurrentPage(1);
            }, [searchTerm]);

            const filteredData = useMemo(() => {
                return liveData.filter(item => 
                    item.target.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.attacker.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.method.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.date.includes(searchTerm)
                );
            }, [liveData, searchTerm]);

            // Pagination Logic
            const indexOfLastItem = currentPage * itemsPerPage;
            const indexOfFirstItem = indexOfLastItem - itemsPerPage;
            const currentItems = filteredData.slice(indexOfFirstItem, indexOfLastItem);
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);

            const paginate = (pageNumber) => setCurrentPage(pageNumber);

            return (
                <div className="min-h-screen pb-12 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-cyber-slate via-cyber-dark to-black">
                    {/* NAV */}
                    <nav className="bg-cyber-dark/80 backdrop-blur-md border-b border-slate-800/50 sticky top-0 z-50 shadow-lg shadow-black/20">
                        <div className="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3 group cursor-pointer" onClick={fetchLiveFeeds}>
                                <div className="relative">
                                    <div className="w-3 h-3 bg-cyber-red rounded-full absolute inset-0 pulse-signal"></div>
                                    <div className="w-3 h-3 bg-cyber-red rounded-full relative z-10 shadow-glow-red"></div>
                                </div>
                                <span className="font-bold text-xl tracking-[0.2em] font-mono text-white group-hover:text-cyber-blue transition-colors">CyberSecurity<span className="text-cyber-blue group-hover:text-white transition-colors">Dashboard</span></span>
                            </div>
                            <div className="flex items-center gap-6">
                                <div className="hidden md:flex flex-col items-end mr-2">
                                    <div className="text-[10px] text-slate-400 uppercase font-bold tracking-wider">System Status</div>
                                    <div className="text-xs font-mono text-cyber-green flex items-center justify-end gap-2 font-bold shadow-glow-green">
                                        {isSyncing ? "FETCHING DATA..." : "SYSTEM ONLINE"} 
                                        <span className={`w-2 h-2 bg-cyber-green rounded-full ${isSyncing ? 'animate-ping' : ''}`}></span>
                                    </div>
                                </div>
                                <div className="flex bg-slate-900/50 rounded-md p-1 border border-slate-800/50">
                                    <button onClick={() => setView('dashboard')} className={`px-4 py-2 text-xs font-bold uppercase tracking-wider rounded-sm transition-all ${view === 'dashboard' ? 'bg-cyber-blue text-cyber-dark shadow-glow-blue' : 'text-slate-400 hover:text-white hover:bg-slate-800'}`}>Dashboard</button>
                                    <button onClick={() => setView('report')} className={`px-4 py-2 text-xs font-bold uppercase tracking-wider rounded-sm transition-all ${view === 'report' ? 'bg-cyber-blue text-cyber-dark shadow-glow-blue' : 'text-slate-400 hover:text-white hover:bg-slate-800'}`}>Briefings</button>
                                </div>
                                <button onClick={fetchLiveFeeds} className="p-2 text-cyber-blue hover:text-white hover:bg-cyber-blue/20 rounded-full transition-all border border-cyber-blue/30 hover:border-cyber-blue hover:shadow-glow-blue" title="Force Refresh Feeds">
                                    <svg className={`w-5 h-5 ${isSyncing ? 'animate-spin' : ''}`} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                                </button>
                            </div>
                        </div>
                    </nav>

                    {/* DASHBOARD VIEW */}
                    {view === 'dashboard' && (
                        <main className="max-w-7xl mx-auto px-6 mt-10 space-y-8 slide-in">
                            {/* KPI Grid */}
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                                <div className="cyber-card p-6 rounded-xl relative overflow-hidden border-l-4 border-cyber-blue group">
                                    <div className="absolute right-4 top-4 text-cyber-blue/10 group-hover:text-cyber-blue/30 transition-all"><svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor"><path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0zM13 17a2 2 0 11-4 0 2 2 0 014 0z" /><path fillRule="evenodd" d="M4 5a2 2 0 012-2h12a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm2 0v7h12V5H6z" clipRule="evenodd" /></svg></div>
                                    <h3 className="text-xs text-cyber-blue font-bold uppercase tracking-widest mb-2">Total Events Logged</h3>
                                    <div className="text-4xl font-mono font-black text-white shadow-glow-blue">{liveData.length}</div>
                                    <div className="text-xs text-slate-500 mt-2 font-mono">Scope: Oct 2025 - Present</div>
                                </div>
                                <div className="cyber-card p-6 rounded-xl relative overflow-hidden border-l-4 border-cyber-green group">
                                     <div className="absolute right-4 top-4 text-cyber-green/10 group-hover:text-cyber-green/30 transition-all"><svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor"><path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clipRule="evenodd" /></svg></div>
                                    <h3 className="text-xs text-cyber-green font-bold uppercase tracking-widest mb-2">Last Data Sync</h3>
                                    <div className="text-2xl font-mono font-bold text-white mt-3">{lastUpdated}</div>
                                    <div className="text-xs text-slate-500 mt-2 font-mono">Auto-refresh active</div>
                                </div>
                                <div className="cyber-card p-6 rounded-xl relative overflow-hidden border-l-4 border-cyber-yellow group">
                                    <div className="absolute right-4 top-4 text-cyber-yellow/10 group-hover:text-cyber-yellow/30 transition-all"><svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a1 1 0 00-.365-.38L3.31 12.397a1 1 0 110-3zM8 14.222V10.12l1.69-.723a1 1 0 011.322 0l1.69.723v4.102a1 1 0 11-3.382 0zM18 12.397l-1.325 1.445a1 1 0 00-.365.38v-4.102l1.69-.723a1 1 0 110 3z" /></svg></div>
                                    <h3 className="text-xs text-cyber-yellow font-bold uppercase tracking-widest mb-2">Active Intel Sources</h3>
                                    <div className="text-4xl font-mono font-black text-white">{FEED_SOURCES.length}</div>
                                    <div className="text-xs text-slate-500 mt-2 font-mono">RSS/ATOM Feeds</div>
                                </div>
                                <div className="cyber-card p-6 rounded-xl relative overflow-hidden border-l-4 border-cyber-red group">
                                    <div className="absolute right-4 top-4 text-cyber-red/10 group-hover:text-cyber-red/30 transition-all pulse-signal"><svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor"><path fillRule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clipRule="evenodd" /></svg></div>
                                    <h3 className="text-xs text-cyber-red font-bold uppercase tracking-widest mb-2">High Severity Threats</h3>
                                    <div className="text-4xl font-mono font-black text-cyber-red shadow-glow-red">{liveData.filter(i => i.method === "Ransomware" || i.method === "Zero-Day Exploit").length}</div>
                                    <div className="text-xs text-slate-500 mt-2 font-mono">Ransomware / 0-Day</div>
                                </div>
                            </div>

                            {/* Main Content Grid */}
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                {/* Left Column: Charts & Table */}
                                <div className="lg:col-span-2 space-y-6">
                                    {/* Charts Grid */}
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <TrendChart data={liveData} />
                                        <TypeDistributionChart data={liveData} />
                                    </div>
                                    
                                    {/* Search & Controls */}
                                    <div className="flex gap-4 items-center p-1 bg-slate-900/50 rounded-lg border border-slate-800/50">
                                        <div className="relative flex-1">
                                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                <svg className="h-4 w-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                            </div>
                                            <input type="text" placeholder="Search logs (target, vector, cost)..." className="w-full pl-10 pr-4 py-3 bg-transparent text-sm text-white font-mono focus:outline-none border-none focus:ring-0 placeholder-slate-600" onChange={(e) => setSearchTerm(e.target.value)} />
                                        </div>
                                    </div>

                                    {/* Data Table */}
                                    <div className="cyber-card rounded-xl overflow-hidden shadow-screen flex flex-col">
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-left text-sm">
                                                <thead className="bg-[#0a0f1d] text-slate-400 uppercase text-[11px] font-bold tracking-wider border-b border-slate-800">
                                                    <tr>
                                                        <th className="p-5">Timestamp</th>
                                                        <th className="p-5">Target / Sector</th>
                                                        <th className="p-5">Attack Vector</th>
                                                        <th className="p-5">Financial Impact</th>
                                                        <th className="p-5 text-right">Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-slate-800/50 font-mono">
                                                    {currentItems.map(row => (
                                                        <tr key={row.id} className="hover:bg-cyber-blue/5 transition-all group">
                                                            <td className="p-5 text-cyber-blue whitespace-nowrap">{row.date}</td>
                                                            <td className="p-5 font-sans">
                                                                <div className="font-bold text-white text-base mb-1 group-hover:text-cyber-blue transition-colors line-clamp-1">{row.target}</div>
                                                                <div className="text-xs text-slate-500 font-bold uppercase tracking-wider">{row.sector}</div>
                                                            </td>
                                                            <td className="p-5">
                                                                <span className={`px-2 py-1 text-[10px] font-bold uppercase rounded-sm border ${
                                                                    row.method.includes('Ransom') ? 'bg-cyber-red/10 text-cyber-red border-cyber-red/30' :
                                                                    row.method.includes('Zero') ? 'bg-cyber-red/10 text-cyber-red border-cyber-red/30' :
                                                                    'bg-cyber-blue/10 text-cyber-blue border-cyber-blue/30'
                                                                }`}>{row.method}</span>
                                                            </td>
                                                            <td className="p-5">
                                                                <span className={`font-bold ${row.cost.includes('$') || row.cost.includes('Million') ? 'text-cyber-yellow' : 'text-slate-500'}`}>
                                                                    {row.cost}
                                                                </span>
                                                            </td>
                                                            <td className="p-5 text-right">
                                                                <button onClick={() => setSelectedEvent(row)} className="text-xs font-bold uppercase tracking-wider text-slate-400 hover:text-cyber-blue border border-slate-700 hover:border-cyber-blue px-3 py-1 rounded-sm transition-all hover:shadow-glow-blue">
                                                                    Analyze &rarr;
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                        {/* Pagination Controls */}
                                        <div className="bg-[#0a0f1d] border-t border-slate-800 p-4 flex justify-between items-center">
                                            <div className="text-xs text-slate-500 font-mono">
                                                Showing <span className="text-white">{indexOfFirstItem + 1}</span> to <span className="text-white">{Math.min(indexOfLastItem, filteredData.length)}</span> of <span className="text-white">{filteredData.length}</span> entries
                                            </div>
                                            <div className="flex gap-2">
                                                <button 
                                                    onClick={() => paginate(currentPage - 1)} 
                                                    disabled={currentPage === 1}
                                                    className="px-3 py-1 text-xs font-bold uppercase bg-slate-800 text-slate-300 border border-slate-700 hover:border-cyber-blue disabled:opacity-50 disabled:hover:border-slate-700 transition-all rounded-sm"
                                                >
                                                    Previous
                                                </button>
                                                <button 
                                                    onClick={() => paginate(currentPage + 1)} 
                                                    disabled={currentPage === totalPages}
                                                    className="px-3 py-1 text-xs font-bold uppercase bg-slate-800 text-slate-300 border border-slate-700 hover:border-cyber-blue disabled:opacity-50 disabled:hover:border-slate-700 transition-all rounded-sm"
                                                >
                                                    Next
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Right Column: Sidebar */}
                                <div className="space-y-6">
                                    <div className="cyber-card p-6 rounded-xl border-t-4 border-cyber-green relative overflow-hidden">
                                        <div className="absolute inset-0 bg-cyber-green/5 animate-pulse pointer-events-none"></div>
                                        <h4 className="text-sm font-bold text-cyber-green uppercase mb-4 tracking-wider flex items-center gap-2">
                                            <svg className="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                            Live Feed Connectors
                                        </h4>
                                        <ul className="space-y-3 mb-6">
                                            {FEED_SOURCES.map((src, i) => (
                                                <li key={i} className="flex items-center justify-between text-xs text-slate-300 border-b border-slate-800/50 pb-2 last:border-0">
                                                    <span className="flex items-center gap-2">
                                                        <span className="w-1.5 h-1.5 rounded-full bg-cyber-green shadow-glow-green"></span>
                                                        {src.name}
                                                    </span>
                                                    <span className="text-cyber-green font-mono">[OK]</span>
                                                </li>
                                            ))}
                                        </ul>
                                        <div className="p-4 bg-[#0a0f1d] rounded-md border border-cyber-blue/30 text-xs text-slate-400 leading-relaxed shadow-screen font-mono">
                                            <strong className="block text-cyber-blue mb-2 uppercase tracking-wider">/// SYSTEM NOTE: AUTO-UPDATE ACTIVE</strong>
                                            This dashboard is connected to live RSS threat feeds. <strong>Refreshing this page will automatically fetch and display new incidents</strong> published today by the connected sources.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </main>
                    )}

                    {/* REPORT VIEW */}
                    {view === 'report' && (
                        <main className="max-w-5xl mx-auto mt-12 px-6 slide-in">
                            <DailyReport data={liveData} date={liveData[0]?.date || new Date().toISOString().split('T')[0]} />
                        </main>
                    )}

                    {/* MODAL (Incident Details) */}
                    {selectedEvent && (
                        <div className="fixed inset-0 bg-[#050a14]/95 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
                            <div className="cyber-card w-full max-w-2xl rounded-xl border-t-4 border-cyber-red shadow-2xl overflow-hidden relative slide-in">
                                <div className="absolute inset-0 bg-cyber-red/5 pointer-events-none"></div>
                                {/* Modal Header */}
                                <div className="bg-[#0a0f1d] p-6 border-b border-slate-800 flex justify-between items-start relative z-10">
                                    <div>
                                        <div className="flex items-center gap-3 mb-3">
                                            <span className="bg-cyber-red/10 text-cyber-red border border-cyber-red/30 px-3 py-1 text-xs font-bold uppercase tracking-wider rounded-sm shadow-glow-red">Critical Incident</span>
                                            <span className="text-slate-400 font-mono text-sm flex items-center gap-1"><svg className="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg> {selectedEvent.date}</span>
                                        </div>
                                        <h2 className="text-2xl font-black text-white uppercase tracking-tight">{selectedEvent.target}</h2>
                                    </div>
                                    <button onClick={() => setSelectedEvent(null)} className="text-slate-500 hover:text-cyber-red transition-colors p-1 hover:bg-slate-800 rounded-full"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
                                </div>
                                
                                {/* Modal Body */}
                                <div className="p-8 relative z-10 space-y-8">
                                    <div className="grid grid-cols-2 gap-6">
                                        <div className="bg-[#0a0f1d] p-4 rounded-lg border border-slate-800 shadow-screen">
                                            <div className="text-xs text-slate-500 uppercase font-bold tracking-wider mb-1">Threat Actor / Group</div>
                                            <div className="text-lg text-cyber-red font-mono font-bold">{selectedEvent.attacker}</div>
                                        </div>
                                        <div className="bg-[#0a0f1d] p-4 rounded-lg border border-slate-800 shadow-screen">
                                            <div className="text-xs text-slate-500 uppercase font-bold tracking-wider mb-1">Attack Vector</div>
                                            <div className="text-lg text-cyber-blue font-mono font-bold">{selectedEvent.method}</div>
                                        </div>
                                         <div className="bg-[#0a0f1d] p-4 rounded-lg border border-slate-800 shadow-screen col-span-2">
                                            <div className="text-xs text-slate-500 uppercase font-bold tracking-wider mb-1">Financial Impact</div>
                                            <div className="text-lg text-cyber-yellow font-mono font-bold">{selectedEvent.cost}</div>
                                        </div>
                                    </div>

                                    <div>
                                        <h3 className="text-sm font-bold text-white uppercase tracking-wider mb-3 flex items-center gap-2"><svg className="w-4 h-4 text-cyber-blue" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> Impact Summary</h3>
                                        <div className="bg-slate-900/80 p-5 rounded-lg border border-slate-700/50 text-slate-300 text-sm leading-relaxed font-mono shadow-screen">
                                            {selectedEvent.impact}
                                        </div>
                                    </div>

                                    <div>
                                        <h3 className="text-sm font-bold text-cyber-yellow uppercase tracking-wider mb-3 flex items-center gap-2"><svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg> Mitigation Strategy</h3>
                                        <div className="bg-cyber-yellow/10 border-l-4 border-cyber-yellow p-5 text-cyber-yellow text-sm font-medium rounded-r-lg leading-relaxed">
                                            {selectedEvent.remediation}
                                        </div>
                                    </div>
                                </div>
                                <div className="bg-[#0a0f1d] p-4 text-right border-t border-slate-800 relative z-10">
                                    <button onClick={() => setSelectedEvent(null)} className="px-6 py-2 bg-slate-800 hover:bg-cyber-red/20 hover:text-cyber-red hover:border-cyber-red border border-slate-700 rounded-sm text-xs font-bold uppercase tracking-wider text-slate-300 transition-all">Close Panel</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
